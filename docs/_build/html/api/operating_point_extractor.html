

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Operating Point Extractor Module &mdash; TSOC Data Analysis 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=8d563738"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Excel Data Processor Module" href="excel_data_processor.html" />
    <link rel="prev" title="Power Data Validator Module" href="power_data_validator.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            TSOC Data Analysis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide.html">User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api_reference.html">API Reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="system_configuration.html">System Configuration Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_system_analytics.html">Power System Analytics Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_system_visualizer.html">Power System Visualizer Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html">Power Data Validator Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#module-overview">Module Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#validation-workflow">Validation Workflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#core-classes">Core Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#advanced-gap-filling">Advanced Gap Filling</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#anomaly-detection">Anomaly Detection</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#power-system-specific-validation">Power System Specific Validation</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#configuration">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#usage-examples">Usage Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#integration-with-analysis-pipeline">Integration with Analysis Pipeline</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_data_validator.html#error-handling">Error Handling</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Operating Point Extractor Module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#clustering-methodology">CLUSTERING METHODOLOGY:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#configuration-integration">CONFIGURATION INTEGRATION:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enhanced-features">ENHANCED FEATURES:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-examples">USAGE EXAMPLES:</a></li>
<li class="toctree-l3"><a class="reference internal" href="#tsoc_data_analysis.operating_point_extractor.extract_representative_ops"><code class="docutils literal notranslate"><span class="pre">extract_representative_ops()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#tsoc_data_analysis.operating_point_extractor.loadallpowerdf"><code class="docutils literal notranslate"><span class="pre">loadallpowerdf()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-overview">Module Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id1">Clustering Methodology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#core-functions">Core Functions</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#extract-representative-ops">extract_representative_ops()</a></li>
<li class="toctree-l4"><a class="reference internal" href="#loadallpowerdf">loadallpowerdf()</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id2">Configuration Integration</a></li>
<li class="toctree-l3"><a class="reference internal" href="#clustering-algorithm">Clustering Algorithm</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#automatic-k-means-selection">Automatic K-Means Selection</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#feature-selection">Feature Selection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mapgl-belt-analysis">MAPGL Belt Analysis</a></li>
<li class="toctree-l3"><a class="reference internal" href="#output-generation">Output Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#diagnostics-and-reporting">Diagnostics and Reporting</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id3">Usage Examples</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#basic-usage">Basic Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#advanced-usage">Advanced Usage</a></li>
<li class="toctree-l4"><a class="reference internal" href="#complete-workflow">Complete Workflow</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#performance-considerations">Performance Considerations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#error-handling">Error Handling</a></li>
<li class="toctree-l3"><a class="reference internal" href="#integration-with-other-modules">Integration with Other Modules</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="excel_data_processor.html">Excel Data Processor Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="power_analysis_cli.html">Power Analysis CLI Module</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference.html#package-overview">Package Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../api_reference.html#quick-import-guide">Quick Import Guide</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../configuration.html">Configuration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">TSOC Data Analysis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../api_reference.html">API Reference</a></li>
      <li class="breadcrumb-item active">Operating Point Extractor Module</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api/operating_point_extractor.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-tsoc_data_analysis.operating_point_extractor">
<span id="operating-point-extractor-module"></span><h1>Operating Point Extractor Module<a class="headerlink" href="#module-tsoc_data_analysis.operating_point_extractor" title="Link to this heading"></a></h1>
<p>Representative Operating Points Extraction Module</p>
<p>Author: Sustainable Power Systems Lab (SPSL)
Web: <a class="reference external" href="https://sps-lab.org">https://sps-lab.org</a>
Contact: <a class="reference external" href="mailto:info&#37;&#52;&#48;sps-lab&#46;org">info<span>&#64;</span>sps-lab<span>&#46;</span>org</a></p>
<p>This module provides functions to extract representative operating points
from power system data using K-means clustering with automatic cluster count selection.</p>
<section id="clustering-methodology">
<h2>CLUSTERING METHODOLOGY:<a class="headerlink" href="#clustering-methodology" title="Link to this heading"></a></h2>
<p>The module implements the methodology described in “Automated Extraction of
Representative Operating Points for a 132 kV Transmission System”:</p>
<ol class="arabic simple">
<li><p>DATA FILTERING: Based on power limits and MAPGL constraints</p></li>
<li><p>FEATURE EXTRACTION: Uses power injection features (ss_mw_*, ss_mvar_*, wind_mw_*)</p></li>
<li><p>STANDARDIZATION: Applies StandardScaler for feature normalization</p></li>
<li><p>CLUSTERING: K-means with automatic cluster count selection using multiple metrics</p></li>
<li><p>MEDOID SELECTION: Returns actual snapshots closest to cluster centers</p></li>
<li><p>MAPGL BELT: Includes critical low-load operating points near MAPGL threshold</p></li>
<li><p>OUTPUT GENERATION: Saves results with clean column names and comprehensive reports</p></li>
</ol>
</section>
<section id="configuration-integration">
<h2>CONFIGURATION INTEGRATION:<a class="headerlink" href="#configuration-integration" title="Link to this heading"></a></h2>
<p>All parameters are imported from config.REPRESENTATIVE_OPS:</p>
<ul class="simple">
<li><p>defaults: k_max, random_state, mapgl_belt_multiplier, fallback_clusters</p></li>
<li><p>kmeans: n_init, algorithm settings</p></li>
<li><p>quality_thresholds: min_silhouette, excellent/good/acceptable thresholds</p></li>
<li><p>ranking_weights: Multi-objective ranking weights for cluster selection</p></li>
<li><p>feature_columns: Column prefixes for clustering features</p></li>
<li><p>output_files: Standardized output file names</p></li>
<li><p>validation: Display limits and data requirements</p></li>
</ul>
</section>
<section id="enhanced-features">
<h2>ENHANCED FEATURES:<a class="headerlink" href="#enhanced-features" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>CLEAN OUTPUT: Uses centralized clean_column_name() for readable CSV files</p></li>
<li><p>QUALITY ASSESSMENT: Multi-objective cluster quality evaluation</p></li>
<li><p>COMPREHENSIVE REPORTING: Detailed clustering summary with diagnostics</p></li>
<li><p>ADAPTIVE ALGORITHMS: Automatically adjusts to data characteristics</p></li>
<li><p>POWER SYSTEM FOCUS: Specialized for electrical power system analysis</p></li>
</ul>
<p>Functions:
- loadallpowerdf(): Load all_power*.csv files from directory
- extract_representative_ops(): Main function to extract representative points
- _select_feature_columns(): Helper to identify clustering features (config-driven)
- _auto_kmeans(): Helper for automatic K-means cluster selection (config-driven)
- _create_clustering_summary(): Generates comprehensive analysis reports</p>
</section>
<section id="usage-examples">
<h2>USAGE EXAMPLES:<a class="headerlink" href="#usage-examples" title="Link to this heading"></a></h2>
<p># Load all_power data from directory
df = loadallpowerdf(‘results’)</p>
<p># Basic usage with default configuration
rep_df, diagnostics = extract_representative_ops(</p>
<blockquote>
<div><p>all_power=df, max_power=850, MAPGL=200</p>
</div></blockquote>
<p>)</p>
<p># Save results with automatic file naming
rep_df, diagnostics = extract_representative_ops(</p>
<blockquote>
<div><p>all_power=df, max_power=850, MAPGL=200,
output_dir=”results”  # Uses config file names</p>
</div></blockquote>
<p>)</p>
<p># Combined workflow: load data and extract representative points
rep_df, diagnostics = extract_representative_ops(</p>
<blockquote>
<div><p>loadallpowerdf(‘results’), max_power=850, MAPGL=200, output_dir=’results’</p>
</div></blockquote>
<p>)</p>
<p># Custom parameters (overrides config defaults)
rep_df, diagnostics = extract_representative_ops(</p>
<blockquote>
<div><p>all_power=df, max_power=850, MAPGL=200,
k_max=15, random_state=123  # Override config values</p>
</div></blockquote>
<p>)</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="tsoc_data_analysis.operating_point_extractor.extract_representative_ops">
<span class="sig-prename descclassname"><span class="pre">tsoc_data_analysis.operating_point_extractor.</span></span><span class="sig-name descname"><span class="pre">extract_representative_ops</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">all_power</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_power</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MAPGL</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k_max</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">random_state</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">42</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tsoc_data_analysis/operating_point_extractor.html#extract_representative_ops"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tsoc_data_analysis.operating_point_extractor.extract_representative_ops" title="Link to this definition"></a></dt>
<dd><p>Extract representative operating points from power system data using clustering.</p>
<p>This function implements the methodology described in “Automated Extraction of
Representative Operating Points for a 132 kV Transmission System” with a
configuration-driven approach for enhanced maintainability and customization.</p>
<section id="configuration-driven-features">
<h2>CONFIGURATION-DRIVEN FEATURES:<a class="headerlink" href="#configuration-driven-features" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>All clustering parameters imported from config.REPRESENTATIVE_OPS</p></li>
<li><p>Default values managed centrally for consistency across analyses</p></li>
<li><p>Feature column selection based on config.REPRESENTATIVE_OPS[‘feature_columns’]</p></li>
<li><p>Output file names standardized via config.REPRESENTATIVE_OPS[‘output_files’]</p></li>
<li><p>Clean column names in CSV output using config.clean_column_name()</p></li>
</ul>
</section>
<section id="clustering-workflow">
<h2>CLUSTERING WORKFLOW:<a class="headerlink" href="#clustering-workflow" title="Link to this heading"></a></h2>
<ol class="arabic simple">
<li><p>Data filtering based on power limits and MAPGL constraints</p></li>
<li><p>Feature extraction using power injection variables (config-driven prefixes)</p></li>
<li><p>Data standardization using StandardScaler</p></li>
<li><p>K-means clustering with automatic cluster count selection</p></li>
<li><p>Multi-objective quality assessment (silhouette, Calinski-Harabasz, Davies-Bouldin)</p></li>
<li><p>Medoid identification (actual snapshots closest to cluster centers)</p></li>
<li><p>MAPGL belt analysis for critical low-load operating points</p></li>
<li><p>Results saved with clean column names and comprehensive diagnostics</p></li>
</ol>
</section>
<section id="net-load-handling">
<h2>NET LOAD HANDLING:<a class="headerlink" href="#net-load-handling" title="Link to this heading"></a></h2>
<ul class="simple">
<li><p>If ‘net_load’ column exists in input data, it will be used directly</p></li>
<li><p>If ‘net_load’ is missing, it will be calculated from power system data</p></li>
<li><p>This avoids redundant calculations when data already contains computed values</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">type all_power<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a></span></p>
</dd>
<dt class="field-even">param all_power<span class="colon">:</span></dt>
<dd class="field-even"><p>Input time-series DataFrame with power system data including columns:
- ss_mw_*: Substation active power (MW)
- ss_mvar_*: Substation reactive power (MVAR)
- wind_mw_*: Wind farm active power (MW)
- net_load: Net load (optional, will be calculated if not present)
- total_load: Total load (optional, will be calculated if net_load not present)</p>
</dd>
<dt class="field-odd">type all_power<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
<dt class="field-even">type max_power<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
<dt class="field-odd">param max_power<span class="colon">:</span></dt>
<dd class="field-odd"><p>Maximum dispatchable generation for the horizon under study [MW].</p>
</dd>
<dt class="field-even">type max_power<span class="colon">:</span></dt>
<dd class="field-even"><p>float</p>
</dd>
<dt class="field-odd">type MAPGL<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">float</span></code></a></span></p>
</dd>
<dt class="field-even">param MAPGL<span class="colon">:</span></dt>
<dd class="field-even"><p>Minimum active-power generation limit [MW].</p>
</dd>
<dt class="field-odd">type MAPGL<span class="colon">:</span></dt>
<dd class="field-odd"><p>float</p>
</dd>
<dt class="field-even">type k_max<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-odd">param k_max<span class="colon">:</span></dt>
<dd class="field-odd"><p>Upper bound for clusters to test.
Default from config.REPRESENTATIVE_OPS[‘defaults’][‘k_max’].</p>
</dd>
<dt class="field-even">type k_max<span class="colon">:</span></dt>
<dd class="field-even"><p>int, optional</p>
</dd>
<dt class="field-odd">type random_state<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">int</span></code></a></span></p>
</dd>
<dt class="field-even">param random_state<span class="colon">:</span></dt>
<dd class="field-even"><p>Reproducibility parameter for k-means.
Default from config.REPRESENTATIVE_OPS[‘defaults’][‘random_state’].</p>
</dd>
<dt class="field-odd">type random_state<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or None, optional</p>
</dd>
<dt class="field-even">type output_dir<span class="colon">:</span></dt>
<dd class="field-even"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Optional" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Optional</span></code></a>[<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">str</span></code></a>]</span></p>
</dd>
<dt class="field-odd">param output_dir<span class="colon">:</span></dt>
<dd class="field-odd"><p>Directory to save results. If provided, saves files with standardized names:
- representative_operating_points.csv: Clean column names, timestamps as index
- clustering_summary.txt: Comprehensive clustering analysis report
- clustering_info.json: Detailed clustering metrics for programmatic access</p>
</dd>
<dt class="field-even">type output_dir<span class="colon">:</span></dt>
<dd class="field-even"><p>str or None, optional</p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p><span class="sphinx_autodoc_typehints-type"><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><code class="xref py py-data docutils literal notranslate"><span class="pre">Tuple</span></code></a>[<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.1)"><code class="xref py py-class docutils literal notranslate"><span class="pre">DataFrame</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)"><code class="xref py py-class docutils literal notranslate"><span class="pre">dict</span></code></a>]</span></p>
</dd>
<dt class="field-even">returns<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>rep_df</strong> (<em>pandas.DataFrame</em>) – Subset of input DataFrame containing representative operating points
(medoids from clusters plus MAPGL-belt snapshots). Column names retain
original structure for compatibility with analysis functions.</p></li>
<li><p><strong>info</strong> (<em>dict</em>) – Comprehensive diagnostics including:
- ‘k’: Optimal number of clusters selected
- ‘silhouette’: Silhouette score for clustering quality
- ‘ch’: Calinski-Harabasz index
- ‘db’: Davies-Bouldin index
- ‘cluster_sizes’: Number of points in each cluster
- ‘n_medoid’: Number of medoid representatives
- ‘n_belt’: Number of MAPGL belt snapshots
- ‘n_total’: Total representative points
- ‘original_size’: Size of input dataset
- ‘filtered_size’: Size after filtering
- ‘feature_columns’: Columns used for clustering</p></li>
</ul>
</dd>
<dt class="field-odd">raises ValueError<span class="colon">:</span></dt>
<dd class="field-odd"><p>If any surviving snapshot violates net_load &lt; MAPGL, or if no suitable
    feature columns are found for clustering.</p>
</dd>
<dt class="field-even">raises Configuration Dependencies<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">raises ————————-<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">raises This function relies on config.REPRESENTATIVE_OPS for:<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">raises - Default parameter values (k_max, random_state, etc.)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">raises - Clustering quality thresholds<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">raises - Feature column prefixes for automatic selection<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">raises - Multi-objective ranking weights<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">raises - Output file naming conventions<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span><span class="w"> </span><span class="nn">operating_point_extractor</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_representative_ops</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Basic usage with config defaults</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rep_df</span><span class="p">,</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rep_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> representative points from </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> total&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimal clusters: </span><span class="si">{</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;k&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> (quality: </span><span class="si">{</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Save results with clean column names and comprehensive reports</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rep_df</span><span class="p">,</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df</span><span class="p">,</span> <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s2">&quot;./results&quot;</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Files saved: representative_operating_points.csv (clean names),</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1">#               clustering_summary.txt, clustering_info.json</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Override config defaults for custom analysis</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rep_df</span><span class="p">,</span> <span class="n">diag</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">df</span><span class="p">,</span> <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">k_max</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Access comprehensive diagnostics</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compression ratio: </span><span class="si">{</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;original_size&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;n_total&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">:1&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Feature columns: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;feature_columns&#39;</span><span class="p">])</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cluster sizes: </span><span class="si">{</span><span class="n">diag</span><span class="p">[</span><span class="s1">&#39;cluster_sizes&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>all_power</strong> (<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.1)"><em>DataFrame</em></a>)</p></li>
<li><p><strong>max_power</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>MAPGL</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.13)"><em>float</em></a>)</p></li>
<li><p><strong>k_max</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>random_state</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.13)"><em>int</em></a>)</p></li>
<li><p><strong>output_dir</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a><em> | </em><em>None</em>)</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/3/library/typing.html#typing.Tuple" title="(in Python v3.13)"><em>Tuple</em></a>[<a class="reference external" href="https://pandas.pydata.org/docs/reference/api/pandas.DataFrame.html#pandas.DataFrame" title="(in pandas v2.3.1)"><em>DataFrame</em></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.13)">dict</a>]</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="tsoc_data_analysis.operating_point_extractor.loadallpowerdf">
<span class="sig-prename descclassname"><span class="pre">tsoc_data_analysis.operating_point_extractor.</span></span><span class="sig-name descname"><span class="pre">loadallpowerdf</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">directory</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/tsoc_data_analysis/operating_point_extractor.html#loadallpowerdf"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#tsoc_data_analysis.operating_point_extractor.loadallpowerdf" title="Link to this definition"></a></dt>
<dd><p>Load all_power*.csv file from the specified directory into a DataFrame.</p>
<p>This function searches for files matching the pattern ‘all_power*.csv’ in the
specified directory and loads the first matching file. It’s designed to work
with the power system analysis workflow where all_power data files are
generated with timestamps or version suffixes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>directory</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.13)"><em>str</em></a>) – Directory path to search for all_power*.csv files.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Loaded DataFrame with power system data. The index is preserved as
timestamps if present in the original CSV file.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#FileNotFoundError" title="(in Python v3.13)"><strong>FileNotFoundError</strong></a> – If no all_power*.csv file is found in the specified directory.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.13)"><strong>ValueError</strong></a> – If the directory doesn’t exist or is not accessible.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Load all_power data from results directory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">df</span> <span class="o">=</span> <span class="n">loadallpowerdf</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> snapshots with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Use in representative operating points extraction</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rep_df</span><span class="p">,</span> <span class="n">diagnostics</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">loadallpowerdf</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">),</span> <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span> <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span> <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;results&#39;</span>
<span class="gp">... </span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Searches for files matching pattern ‘all_power*.csv’</p></li>
<li><p>Uses pandas.read_csv() with automatic index parsing</p></li>
<li><p>Preserves original column names and data types</p></li>
<li><p>Handles common CSV formats with comma or semicolon separators</p></li>
</ul>
</dd></dl>

<section id="module-overview">
<h2>Module Overview<a class="headerlink" href="#module-overview" title="Link to this heading"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">operating_point_extractor</span></code> module provides functions to extract representative operating points from power system data using K-means clustering with automatic cluster count selection.</p>
<p>This module implements the methodology described in “Automated Extraction of Representative Operating Points for a 132 kV Transmission System” and provides a comprehensive solution for identifying key operating states in power system data.</p>
</section>
<section id="id1">
<h2>Clustering Methodology<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>The module follows a systematic approach to extract representative operating points:</p>
<ol class="arabic simple">
<li><p><strong>Data Filtering</strong>: Based on power limits and MAPGL constraints</p></li>
<li><p><strong>Feature Extraction</strong>: Uses power injection features (<code class="docutils literal notranslate"><span class="pre">ss_mw_*</span></code>, <code class="docutils literal notranslate"><span class="pre">ss_mvar_*</span></code>, <code class="docutils literal notranslate"><span class="pre">wind_mw_*</span></code>)</p></li>
<li><p><strong>Standardization</strong>: Applies StandardScaler for feature normalization</p></li>
<li><p><strong>Clustering</strong>: K-means with automatic cluster count selection using multiple metrics</p></li>
<li><p><strong>Medoid Selection</strong>: Returns actual snapshots closest to cluster centers</p></li>
<li><p><strong>MAPGL Belt</strong>: Includes critical low-load operating points near MAPGL threshold</p></li>
<li><p><strong>Output Generation</strong>: Saves results with clean column names and comprehensive reports</p></li>
</ol>
</section>
<section id="core-functions">
<h2>Core Functions<a class="headerlink" href="#core-functions" title="Link to this heading"></a></h2>
<section id="extract-representative-ops">
<h3>extract_representative_ops()<a class="headerlink" href="#extract-representative-ops" title="Link to this heading"></a></h3>
<p>Main function to extract representative operating points from power system data.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">extract_representative_ops</span><span class="p">(</span>
    <span class="n">all_power</span><span class="p">:</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span>
    <span class="n">max_power</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">MAPGL</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
    <span class="n">k_max</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">REPRESENTATIVE_OPS</span><span class="p">[</span><span class="s1">&#39;defaults&#39;</span><span class="p">][</span><span class="s1">&#39;k_max&#39;</span><span class="p">],</span>
    <span class="n">random_state</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="n">REPRESENTATIVE_OPS</span><span class="p">[</span><span class="s1">&#39;defaults&#39;</span><span class="p">][</span><span class="s1">&#39;random_state&#39;</span><span class="p">],</span>
    <span class="n">output_dir</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Extract representative operating points using K-means clustering.</span>

<span class="sd">    Args:</span>
<span class="sd">        all_power: DataFrame containing all power system data</span>
<span class="sd">        max_power: Maximum power limit for filtering</span>
<span class="sd">        MAPGL: Maximum Available Power Generation Limit</span>
<span class="sd">        k_max: Maximum number of clusters to test</span>
<span class="sd">        random_state: Random seed for reproducibility</span>
<span class="sd">        output_dir: Directory to save output files</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of (representative_points_df, diagnostics_dict)</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Parameters:</strong>
- <code class="docutils literal notranslate"><span class="pre">all_power</span></code>: DataFrame with power system data (columns: <code class="docutils literal notranslate"><span class="pre">ss_mw_*</span></code>, <code class="docutils literal notranslate"><span class="pre">ss_mvar_*</span></code>, <code class="docutils literal notranslate"><span class="pre">wind_mw_*</span></code>, etc.)
- <code class="docutils literal notranslate"><span class="pre">max_power</span></code>: Maximum power limit for data filtering (MW)
- <code class="docutils literal notranslate"><span class="pre">MAPGL</span></code>: Maximum Available Power Generation Limit (MW)
- <code class="docutils literal notranslate"><span class="pre">k_max</span></code>: Maximum number of clusters to test (default: 10)
- <code class="docutils literal notranslate"><span class="pre">random_state</span></code>: Random seed for reproducibility (default: 42)
- <code class="docutils literal notranslate"><span class="pre">output_dir</span></code>: Directory to save output files (optional)</p>
<p><strong>Returns:</strong>
- <code class="docutils literal notranslate"><span class="pre">representative_points_df</span></code>: DataFrame with selected representative operating points
- <code class="docutils literal notranslate"><span class="pre">diagnostics_dict</span></code>: Dictionary containing clustering diagnostics and metrics</p>
<p><strong>Example:</strong>
.. code-block:: python</p>
<blockquote>
<div><p>from tsoc_data_analysis import extract_representative_ops</p>
<p># Extract representative points
rep_df, diagnostics = extract_representative_ops(</p>
<blockquote>
<div><p>all_power=df,
max_power=850,
MAPGL=200,
output_dir=”results”</p>
</div></blockquote>
<p>)</p>
<p>print(f”Selected {len(rep_df)} representative points”)
print(f”Clustering quality: {diagnostics[‘silhouette’]:.3f}”)</p>
</div></blockquote>
</section>
<section id="loadallpowerdf">
<h3>loadallpowerdf()<a class="headerlink" href="#loadallpowerdf" title="Link to this heading"></a></h3>
<p>Load all_power*.csv files from a directory.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span><span class="w"> </span><span class="nf">loadallpowerdf</span><span class="p">(</span><span class="n">directory</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Load all_power*.csv files from directory.</span>

<span class="sd">    Args:</span>
<span class="sd">        directory: Directory containing CSV files</span>

<span class="sd">    Returns:</span>
<span class="sd">        DataFrame with merged data from all CSV files</span>
<span class="sd">    &quot;&quot;&quot;</span>
</pre></div>
</div>
<p><strong>Example:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tsoc_data_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">loadallpowerdf</span>

<span class="c1"># Load data from results directory</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">loadallpowerdf</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Loaded </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="si">}</span><span class="s2"> snapshots with </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span><span class="si">}</span><span class="s2"> columns&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="id2">
<h2>Configuration Integration<a class="headerlink" href="#id2" title="Link to this heading"></a></h2>
<p>All parameters are imported from <code class="docutils literal notranslate"><span class="pre">system_configuration.REPRESENTATIVE_OPS</span></code>:</p>
<p><strong>Default Settings:</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">REPRESENTATIVE_OPS</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;defaults&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;k_max&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span>                    <span class="c1"># Maximum clusters to test</span>
        <span class="s1">&#39;random_state&#39;</span><span class="p">:</span> <span class="mi">42</span><span class="p">,</span>             <span class="c1"># Reproducibility seed</span>
        <span class="s1">&#39;mapgl_belt_multiplier&#39;</span><span class="p">:</span> <span class="mf">1.1</span><span class="p">,</span>   <span class="c1"># MAPGL belt definition</span>
        <span class="s1">&#39;fallback_clusters&#39;</span><span class="p">:</span> <span class="mi">2</span>          <span class="c1"># Fallback if no quality clusters</span>
    <span class="p">},</span>
    <span class="s1">&#39;quality_thresholds&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;min_silhouette&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>         <span class="c1"># Minimum clustering quality</span>
        <span class="s1">&#39;silhouette_excellent&#39;</span><span class="p">:</span> <span class="mf">0.7</span><span class="p">,</span>    <span class="c1"># Excellent quality threshold</span>
        <span class="s1">&#39;silhouette_good&#39;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">,</span>         <span class="c1"># Good quality threshold</span>
    <span class="p">},</span>
    <span class="s1">&#39;ranking_weights&#39;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s1">&#39;silhouette_weight&#39;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>      <span class="c1"># Multi-objective ranking weights</span>
        <span class="s1">&#39;calinski_harabasz_weight&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="s1">&#39;davies_bouldin_weight&#39;</span><span class="p">:</span> <span class="mi">10</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Customization:</strong></p>
<p>Users can override configuration values by passing parameters directly to functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Override configuration defaults</span>
<span class="n">rep_df</span><span class="p">,</span> <span class="n">diagnostics</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span>
    <span class="n">all_power</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
    <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">k_max</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>           <span class="c1"># Override default k_max</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span>    <span class="c1"># Override default random_state</span>
<span class="p">)</span>
</pre></div>
</div>
</section>
<section id="clustering-algorithm">
<h2>Clustering Algorithm<a class="headerlink" href="#clustering-algorithm" title="Link to this heading"></a></h2>
<section id="automatic-k-means-selection">
<h3>Automatic K-Means Selection<a class="headerlink" href="#automatic-k-means-selection" title="Link to this heading"></a></h3>
<p>The module uses an automatic cluster count selection algorithm that evaluates multiple metrics:</p>
<p><strong>Quality Metrics:</strong>
- <strong>Silhouette Score</strong>: Measures cluster cohesion and separation
- <strong>Calinski-Harabasz Score</strong>: Ratio of between-cluster to within-cluster variance
- <strong>Davies-Bouldin Score</strong>: Average similarity measure of clusters</p>
<p><strong>Selection Process:</strong>
1. Test cluster counts from 2 to <code class="docutils literal notranslate"><span class="pre">k_max</span></code>
2. Calculate quality metrics for each cluster count
3. Apply multi-objective ranking with configurable weights
4. Select optimal cluster count based on quality thresholds
5. Fall back to default if no clusters meet quality requirements</p>
<p><strong>Quality Thresholds:</strong>
- <strong>Excellent</strong>: Silhouette score ≥ 0.7
- <strong>Good</strong>: Silhouette score ≥ 0.5
- <strong>Acceptable</strong>: Silhouette score ≥ 0.25
- <strong>Minimum</strong>: Silhouette score ≥ 0.1</p>
</section>
</section>
<section id="feature-selection">
<h2>Feature Selection<a class="headerlink" href="#feature-selection" title="Link to this heading"></a></h2>
<p>The module automatically identifies clustering features based on column prefixes:</p>
<p><strong>Power Injection Features:</strong>
- <code class="docutils literal notranslate"><span class="pre">ss_mw_*</span></code>: Substation active power (MW)
- <code class="docutils literal notranslate"><span class="pre">ss_mvar_*</span></code>: Substation reactive power (MVAR)
- <code class="docutils literal notranslate"><span class="pre">wind_mw_*</span></code>: Wind farm active power (MW)</p>
<p><strong>Feature Processing:</strong>
1. <strong>Identification</strong>: Automatically finds columns with specified prefixes
2. <strong>Filtering</strong>: Removes columns with insufficient data
3. <strong>Standardization</strong>: Applies StandardScaler for normalization
4. <strong>Validation</strong>: Ensures minimum feature requirements are met</p>
</section>
<section id="mapgl-belt-analysis">
<h2>MAPGL Belt Analysis<a class="headerlink" href="#mapgl-belt-analysis" title="Link to this heading"></a></h2>
<p>The module includes special handling for critical low-load operating points near the MAPGL threshold:</p>
<p><strong>MAPGL Belt Definition:</strong>
- <strong>Belt Range</strong>: MAPGL ± (MAPGL × <code class="docutils literal notranslate"><span class="pre">mapgl_belt_multiplier</span></code>)
- <strong>Critical Points</strong>: Operating points within the MAPGL belt
- <strong>Inclusion</strong>: Ensures representation of critical low-load conditions</p>
<p><strong>Belt Processing:</strong>
1. <strong>Identification</strong>: Finds snapshots within MAPGL belt
2. <strong>Clustering</strong>: Includes belt points in clustering analysis
3. <strong>Selection</strong>: Ensures belt points are represented in final selection</p>
</section>
<section id="output-generation">
<h2>Output Generation<a class="headerlink" href="#output-generation" title="Link to this heading"></a></h2>
<p>The module generates comprehensive output files with clean, readable formats:</p>
<p><strong>Output Files:</strong>
- <strong>Representative Points</strong>: CSV file with selected operating points
- <strong>Clustering Summary</strong>: Text report with analysis details
- <strong>Clustering Info</strong>: JSON file with technical metrics
- <strong>Visualizations</strong>: Comprehensive 9-panel analysis dashboard</p>
<p><strong>File Naming:</strong>
Output files use standardized names from configuration:
.. code-block:: python</p>
<blockquote>
<div><dl class="simple">
<dt>REPRESENTATIVE_OPS[‘output_files’] = {</dt><dd><p>‘representative_points’: ‘representative_operating_points.csv’,
‘clustering_summary’: ‘clustering_summary.txt’,
‘clustering_info’: ‘clustering_info.json’</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p><strong>Column Name Cleaning:</strong>
Output files use clean column names via <code class="docutils literal notranslate"><span class="pre">clean_column_name()</span></code> function:
- Removes verbose suffixes (e.g., <code class="docutils literal notranslate"><span class="pre">_132REACTOR_REACTIVE_POWER</span></code>)
- Creates readable, consistent naming
- Maintains data integrity and traceability</p>
</section>
<section id="diagnostics-and-reporting">
<h2>Diagnostics and Reporting<a class="headerlink" href="#diagnostics-and-reporting" title="Link to this heading"></a></h2>
<p>The module provides comprehensive diagnostics and reporting capabilities:</p>
<p><strong>Diagnostics Dictionary:</strong>
.. code-block:: python</p>
<blockquote>
<div><dl class="simple">
<dt>diagnostics = {</dt><dd><p>‘n_total’: len(rep_df),                    # Number of representative points
‘original_size’: len(all_power),           # Original dataset size
‘working_size’: len(working),              # Filtered dataset size
‘silhouette’: silhouette_score,            # Clustering quality
‘n_clusters’: n_clusters,                  # Selected cluster count
‘compression_ratio’: compression_ratio,    # Data compression achieved
‘mapgl_belt_points’: mapgl_belt_count,     # MAPGL belt points included
‘feature_columns’: feature_columns,        # Features used for clustering
‘clustering_metrics’: clustering_metrics   # Detailed quality metrics</p>
</dd>
</dl>
<p>}</p>
</div></blockquote>
<p><strong>Clustering Summary Report:</strong>
- <strong>Data Overview</strong>: Original and filtered dataset statistics
- <strong>Clustering Results</strong>: Selected cluster count and quality metrics
- <strong>Representative Points</strong>: Summary of selected operating points
- <strong>MAPGL Analysis</strong>: Belt point inclusion and analysis
- <strong>Quality Assessment</strong>: Detailed clustering quality evaluation</p>
</section>
<section id="id3">
<h2>Usage Examples<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<section id="basic-usage">
<h3>Basic Usage<a class="headerlink" href="#basic-usage" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tsoc_data_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="n">extract_representative_ops</span><span class="p">,</span> <span class="n">loadallpowerdf</span>

<span class="c1"># Load data and extract representative points</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">loadallpowerdf</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">)</span>
<span class="n">rep_df</span><span class="p">,</span> <span class="n">diagnostics</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span>
    <span class="n">all_power</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
    <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;results&#39;</span>
<span class="p">)</span>

<span class="c1"># Display results</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Selected </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">rep_df</span><span class="p">)</span><span class="si">}</span><span class="s2"> representative points&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Compression ratio: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;original_size&#39;</span><span class="p">]</span><span class="o">/</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;n_total&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">:1&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Clustering quality: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="advanced-usage">
<h3>Advanced Usage<a class="headerlink" href="#advanced-usage" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Custom clustering parameters</span>
<span class="n">rep_df</span><span class="p">,</span> <span class="n">diagnostics</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span>
    <span class="n">all_power</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
    <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">k_max</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span>           <span class="c1"># Test more clusters</span>
    <span class="n">random_state</span><span class="o">=</span><span class="mi">123</span><span class="p">,</span>   <span class="c1"># Custom random seed</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;custom_results&#39;</span>
<span class="p">)</span>

<span class="c1"># Analyze diagnostics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Clustering Diagnostics:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Original dataset: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;original_size&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> points&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Filtered dataset: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;working_size&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> points&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Representative points: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;n_total&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> points&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Selected clusters: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;n_clusters&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Silhouette score: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;silhouette&#39;</span><span class="p">]</span><span class="si">:</span><span class="s2">.3f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  MAPGL belt points: </span><span class="si">{</span><span class="n">diagnostics</span><span class="p">[</span><span class="s1">&#39;mapgl_belt_points&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="complete-workflow">
<h3>Complete Workflow<a class="headerlink" href="#complete-workflow" title="Link to this heading"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span><span class="w"> </span><span class="nn">tsoc_data_analysis</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">loadallpowerdf</span><span class="p">,</span>
    <span class="n">extract_representative_ops</span><span class="p">,</span>
    <span class="n">calculate_total_load</span><span class="p">,</span>
    <span class="n">calculate_net_load</span>
<span class="p">)</span>

<span class="c1"># Step 1: Load data</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">loadallpowerdf</span><span class="p">(</span><span class="s1">&#39;results&#39;</span><span class="p">)</span>

<span class="c1"># Step 2: Basic analysis</span>
<span class="n">total_load</span> <span class="o">=</span> <span class="n">calculate_total_load</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">net_load</span> <span class="o">=</span> <span class="n">calculate_net_load</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">total_load</span><span class="p">)</span>

<span class="c1"># Step 3: Extract representative points</span>
<span class="n">rep_df</span><span class="p">,</span> <span class="n">diagnostics</span> <span class="o">=</span> <span class="n">extract_representative_ops</span><span class="p">(</span>
    <span class="n">all_power</span><span class="o">=</span><span class="n">df</span><span class="p">,</span>
    <span class="n">max_power</span><span class="o">=</span><span class="mi">850</span><span class="p">,</span>
    <span class="n">MAPGL</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
    <span class="n">output_dir</span><span class="o">=</span><span class="s1">&#39;results&#39;</span>
<span class="p">)</span>

<span class="c1"># Step 4: Validate representative points</span>
<span class="n">rep_total_load</span> <span class="o">=</span> <span class="n">calculate_total_load</span><span class="p">(</span><span class="n">rep_df</span><span class="p">)</span>
<span class="n">rep_net_load</span> <span class="o">=</span> <span class="n">calculate_net_load</span><span class="p">(</span><span class="n">rep_df</span><span class="p">,</span> <span class="n">rep_total_load</span><span class="p">)</span>

<span class="c1"># Step 5: Compare statistics</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Original vs Representative Points:&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Original average net load: </span><span class="si">{</span><span class="n">net_load</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;  Representative average net load: </span><span class="si">{</span><span class="n">rep_net_load</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> MW&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="performance-considerations">
<h2>Performance Considerations<a class="headerlink" href="#performance-considerations" title="Link to this heading"></a></h2>
<p><strong>Optimization Features:</strong>
- <strong>Parallel Processing</strong>: Uses joblib for parallel cluster evaluation
- <strong>Memory Efficiency</strong>: Processes data in chunks for large datasets
- <strong>Adaptive Algorithms</strong>: Automatically adjusts to data characteristics
- <strong>Early Termination</strong>: Stops evaluation when quality thresholds are met</p>
<p><strong>Scalability:</strong>
- <strong>Large Datasets</strong>: Handles datasets with thousands of time points
- <strong>Many Features</strong>: Efficiently processes hundreds of power system variables
- <strong>Multiple Clusters</strong>: Scales to test up to 20+ cluster counts
- <strong>Memory Management</strong>: Optimized for memory-constrained environments</p>
</section>
<section id="error-handling">
<h2>Error Handling<a class="headerlink" href="#error-handling" title="Link to this heading"></a></h2>
<p><strong>Comprehensive Error Handling:</strong>
- <strong>Data Validation</strong>: Checks for required columns and data quality
- <strong>Feature Requirements</strong>: Ensures minimum feature count for clustering
- <strong>Quality Thresholds</strong>: Handles cases where no clusters meet quality requirements
- <strong>File Operations</strong>: Graceful handling of file I/O errors
- <strong>Memory Issues</strong>: Handles out-of-memory conditions gracefully</p>
<p><strong>Fallback Mechanisms:</strong>
- <strong>Default Clusters</strong>: Falls back to 2 clusters if quality requirements not met
- <strong>Feature Selection</strong>: Adapts to available data columns
- <strong>Output Directory</strong>: Creates directories if they don’t exist
- <strong>File Naming</strong>: Handles file naming conflicts gracefully</p>
</section>
<section id="integration-with-other-modules">
<h2>Integration with Other Modules<a class="headerlink" href="#integration-with-other-modules" title="Link to this heading"></a></h2>
<p>This module integrates seamlessly with other package modules:</p>
<ul class="simple">
<li><p><strong>Data Loading</strong>: Works with data from <code class="docutils literal notranslate"><span class="pre">excel_data_processor</span></code></p></li>
<li><p><strong>Validation</strong>: Compatible with validated data from <code class="docutils literal notranslate"><span class="pre">power_data_validator</span></code></p></li>
<li><p><strong>Analysis</strong>: Results can be analyzed using <code class="docutils literal notranslate"><span class="pre">power_system_analytics</span></code></p></li>
<li><p><strong>Visualization</strong>: Includes comprehensive visualization capabilities</p></li>
<li><p><strong>Configuration</strong>: Uses centralized configuration from <code class="docutils literal notranslate"><span class="pre">system_configuration</span></code></p></li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="power_data_validator.html" class="btn btn-neutral float-left" title="Power Data Validator Module" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="excel_data_processor.html" class="btn btn-neutral float-right" title="Excel Data Processor Module" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Sustainable Power Systems Lab (SPSL).</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>